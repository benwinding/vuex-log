/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/dist/";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/action-logger.js":
/*!******************************!*\
  !*** ./src/action-logger.js ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return createLogger; });
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./util */ "./src/util/index.js");
// Credits: borrowed code from vuejs/vuex



function createLogger() {
  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
      _ref$collapsed = _ref.collapsed,
      collapsed = _ref$collapsed === undefined ? true : _ref$collapsed,
      _ref$filter = _ref.filter,
      filter = _ref$filter === undefined ? function (action, stateBefore, stateAfter) {
    return true;
  } : _ref$filter,
      _ref$transformer = _ref.transformer,
      transformer = _ref$transformer === undefined ? function (state) {
    return state;
  } : _ref$transformer,
      _ref$logger = _ref.logger,
      logger = _ref$logger === undefined ? console : _ref$logger;

  return function (store) {
    var prevState = Object(_util__WEBPACK_IMPORTED_MODULE_0__["deepCopy"])(store.state);

    store.subscribeAction(function (_ref2, state) {
      var type = _ref2.type,
          payload = _ref2.payload;

      if (typeof logger === 'undefined') {
        return;
      }
      var nextState = Object(_util__WEBPACK_IMPORTED_MODULE_0__["deepCopy"])(state);

      if (filter(type, prevState, nextState)) {
        var time = new Date();
        var formattedTime = ' @ ' + pad(time.getHours(), 2) + ':' + pad(time.getMinutes(), 2) + ':' + pad(time.getSeconds(), 2) + '.' + pad(time.getMilliseconds(), 3);
        var message = 'action ' + type + formattedTime;
        var startMessage = collapsed ? logger.groupCollapsed : logger.group;

        // render
        try {
          startMessage.call(logger, message);
        } catch (e) {
          console.log(message);
        }

        logger.log('%c payload', 'color: #9E9E9E; font-weight: bold', { payload: payload });
        logger.log('%c state', 'color: #4CAF50; font-weight: bold', transformer(nextState));

        try {
          logger.groupEnd();
        } catch (e) {
          logger.log('—— log end ——');
        }
      }

      prevState = nextState;
    });
  };
}

function repeat(str, times) {
  return new Array(times + 1).join(str);
}

function pad(num, maxLength) {
  return repeat('0', maxLength - num.toString().length) + num;
}

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/*! exports provided: actionLogger, mutationLogger */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _action_logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./action-logger */ "./src/action-logger.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "actionLogger", function() { return _action_logger__WEBPACK_IMPORTED_MODULE_0__["default"]; });

/* harmony import */ var _mutation_logger__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./mutation-logger */ "./src/mutation-logger.js");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "mutationLogger", function() { return _mutation_logger__WEBPACK_IMPORTED_MODULE_1__["default"]; });






/***/ }),

/***/ "./src/mutation-logger.js":
/*!********************************!*\
  !*** ./src/mutation-logger.js ***!
  \********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return createLogger; });
/* harmony import */ var _util__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./util */ "./src/util/index.js");
// Credits: borrowed code from vuejs/vuex



function createLogger() {
  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},
      _ref$collapsed = _ref.collapsed,
      collapsed = _ref$collapsed === undefined ? true : _ref$collapsed,
      _ref$filter = _ref.filter,
      filter = _ref$filter === undefined ? function (mutation, stateBefore, stateAfter) {
    return true;
  } : _ref$filter,
      _ref$transformer = _ref.transformer,
      transformer = _ref$transformer === undefined ? function (state) {
    return state;
  } : _ref$transformer,
      _ref$mutationTransfor = _ref.mutationTransformer,
      mutationTransformer = _ref$mutationTransfor === undefined ? function (mut) {
    return mut;
  } : _ref$mutationTransfor,
      _ref$logger = _ref.logger,
      logger = _ref$logger === undefined ? console : _ref$logger;

  return function (store) {
    var prevState = Object(_util__WEBPACK_IMPORTED_MODULE_0__["deepCopy"])(store.state);

    store.subscribe(function (mutation, state) {
      if (typeof logger === 'undefined') {
        return;
      }
      var nextState = Object(_util__WEBPACK_IMPORTED_MODULE_0__["deepCopy"])(state);

      if (filter(mutation, prevState, nextState)) {
        var time = new Date();
        var formattedTime = ' @ ' + pad(time.getHours(), 2) + ':' + pad(time.getMinutes(), 2) + ':' + pad(time.getSeconds(), 2) + '.' + pad(time.getMilliseconds(), 3);
        var formattedMutation = mutationTransformer(mutation);
        var message = 'mutation ' + mutation.type + formattedTime;
        var startMessage = collapsed ? logger.groupCollapsed : logger.group;

        // render
        try {
          startMessage.call(logger, message);
        } catch (e) {
          console.log(message);
        }

        logger.log('%c prev state', 'color: #9E9E9E; font-weight: bold', transformer(prevState));
        logger.log('%c mutation', 'color: #03A9F4; font-weight: bold', formattedMutation);
        logger.log('%c next state', 'color: #4CAF50; font-weight: bold', transformer(nextState));

        try {
          logger.groupEnd();
        } catch (e) {
          logger.log('—— log end ——');
        }
      }

      prevState = nextState;
    });
  };
}

function repeat(str, times) {
  return new Array(times + 1).join(str);
}

function pad(num, maxLength) {
  return repeat('0', maxLength - num.toString().length) + num;
}

/***/ }),

/***/ "./src/util/index.js":
/*!***************************!*\
  !*** ./src/util/index.js ***!
  \***************************/
/*! exports provided: find, deepCopy, forEachValue, isObject, isPromise, assert, partial */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "find", function() { return find; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "deepCopy", function() { return deepCopy; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "forEachValue", function() { return forEachValue; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isObject", function() { return isObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isPromise", function() { return isPromise; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "assert", function() { return assert; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "partial", function() { return partial; });
var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

// Credits: borrowed code from vuejs/vuex

/**
 * Get the first item that pass the test
 * by second argument function
 *
 * @param {Array} list
 * @param {Function} f
 * @return {*}
 */
function find(list, f) {
  return list.filter(f)[0];
}

/**
 * Deep copy the given object considering circular structure.
 * This function caches all nested objects and its copies.
 * If it detects circular structure, use cached copy to avoid infinite loop.
 *
 * @param {*} obj
 * @param {Array<Object>} cache
 * @return {*}
 */
function deepCopy(obj) {
  var cache = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

  // just return if obj is immutable value
  if (obj === null || (typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) !== 'object') {
    return obj;
  }

  // if obj is hit, it is in circular structure
  var hit = find(cache, function (c) {
    return c.original === obj;
  });
  if (hit) {
    return hit.copy;
  }

  var copy = Array.isArray(obj) ? [] : {};
  // put the copy into cache at first
  // because we want to refer it in recursive deepCopy
  cache.push({
    original: obj,
    copy: copy
  });

  Object.keys(obj).forEach(function (key) {
    copy[key] = deepCopy(obj[key], cache);
  });

  return copy;
}

/**
 * forEach for object
 */
function forEachValue(obj, fn) {
  Object.keys(obj).forEach(function (key) {
    return fn(obj[key], key);
  });
}

function isObject(obj) {
  return obj !== null && (typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) === 'object';
}

function isPromise(val) {
  return val && typeof val.then === 'function';
}

function assert(condition, msg) {
  if (!condition) throw new Error('[vuex] ' + msg);
}

function partial(fn, arg) {
  return function () {
    return fn(arg);
  };
}

/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FjdGlvbi1sb2dnZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9tdXRhdGlvbi1sb2dnZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvaW5kZXguanMiXSwibmFtZXMiOlsiY3JlYXRlTG9nZ2VyIiwiY29sbGFwc2VkIiwiZmlsdGVyIiwiYWN0aW9uIiwic3RhdGVCZWZvcmUiLCJzdGF0ZUFmdGVyIiwidHJhbnNmb3JtZXIiLCJzdGF0ZSIsImxvZ2dlciIsImNvbnNvbGUiLCJwcmV2U3RhdGUiLCJkZWVwQ29weSIsInN0b3JlIiwic3Vic2NyaWJlQWN0aW9uIiwidHlwZSIsInBheWxvYWQiLCJuZXh0U3RhdGUiLCJ0aW1lIiwiRGF0ZSIsImZvcm1hdHRlZFRpbWUiLCJwYWQiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiLCJnZXRTZWNvbmRzIiwiZ2V0TWlsbGlzZWNvbmRzIiwibWVzc2FnZSIsInN0YXJ0TWVzc2FnZSIsImdyb3VwQ29sbGFwc2VkIiwiZ3JvdXAiLCJjYWxsIiwiZSIsImxvZyIsImdyb3VwRW5kIiwicmVwZWF0Iiwic3RyIiwidGltZXMiLCJBcnJheSIsImpvaW4iLCJudW0iLCJtYXhMZW5ndGgiLCJ0b1N0cmluZyIsImxlbmd0aCIsIm11dGF0aW9uIiwibXV0YXRpb25UcmFuc2Zvcm1lciIsIm11dCIsInN1YnNjcmliZSIsImZvcm1hdHRlZE11dGF0aW9uIiwiZmluZCIsImxpc3QiLCJmIiwib2JqIiwiY2FjaGUiLCJoaXQiLCJjIiwib3JpZ2luYWwiLCJjb3B5IiwiaXNBcnJheSIsInB1c2giLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsImtleSIsImZvckVhY2hWYWx1ZSIsImZuIiwiaXNPYmplY3QiLCJpc1Byb21pc2UiLCJ2YWwiLCJ0aGVuIiwiYXNzZXJ0IiwiY29uZGl0aW9uIiwibXNnIiwi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LEVBQXJCLEdBQTBCLEVBQXZDO0FBQ0E7QUFDQTtBQUNBQyxRQUFNTSxJQUFOLENBQVc7QUFDVEgsY0FBVUosR0FERDtBQUVUSztBQUZTLEdBQVg7O0FBS0FHLFNBQU9DLElBQVAsQ0FBWVQsR0FBWixFQUFpQlUsT0FBakIsQ0FBeUIsZUFBTztBQUM5QkwsU0FBS00sR0FBTCxJQUFZbEQsU0FBU3VDLElBQUlXLEdBQUosQ0FBVCxFQUFtQlYsS0FBbkIsQ0FBWjtBQUNELEdBRkQ7O0FBSUEsU0FBT0ksSUFBUDtBQUNEOztBQUVEOzs7QUFHTyxTQUFTTyxZQUFULENBQXVCWixHQUF2QixFQUE0QmEsRUFBNUIsRUFBZ0M7QUFDckNMLFNBQU9DLElBQVAsQ0FBWVQsR0FBWixFQUFpQlUsT0FBakIsQ0FBeUI7QUFBQSxXQUFPRyxHQUFHYixJQUFJVyxHQUFKLENBQUgsRUFBYUEsR0FBYixDQUFQO0FBQUEsR0FBekI7QUFDRDs7QUFFTSxTQUFTRyxRQUFULENBQW1CZCxHQUFuQixFQUF3QjtBQUM3QixTQUFPQSxRQUFRLElBQVIsSUFBZ0IsUUFBT0EsR0FBUCx5Q0FBT0EsR0FBUCxPQUFlLFFBQXRDO0FBQ0Q7O0FBRU0sU0FBU2UsU0FBVCxDQUFvQkMsR0FBcEIsRUFBeUI7QUFDOUIsU0FBT0EsT0FBTyxPQUFPQSxJQUFJQyxJQUFYLEtBQW9CLFVBQWxDO0FBQ0Q7O0FBRU0sU0FBU0MsTUFBVCxDQUFpQkMsU0FBakIsRUFBNEJDLEdBQTVCLEVBQWlDO0FBQ3RDLE1BQUksQ0FBQ0QsU0FBTCxFQUFnQixNQUFNLElBQUlFLEtBQUosYUFBb0JELEdBQXBCLENBQU47QUFDakI7O0FBRU0sU0FBU0UsT0FBVCxDQUFrQlQsRUFBbEIsRUFBc0JVLEdBQXRCLEVBQTJCO0FBQ2hDLFNBQU8sWUFBWTtBQUNqQixXQUFPVixHQUFHVSxHQUFILENBQVA7QUFDRCxHQUZEO0FBR0QsQyIsImZpbGUiOiJpbmRleC1kZXYubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvZGlzdC9cIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IFwiLi9zcmMvaW5kZXguanNcIik7XG4iLCIvLyBDcmVkaXRzOiBib3Jyb3dlZCBjb2RlIGZyb20gdnVlanMvdnVleFxuXG5pbXBvcnQgeyBkZWVwQ29weSB9IGZyb20gJy4vdXRpbCdcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gY3JlYXRlTG9nZ2VyICh7XG4gIGNvbGxhcHNlZCA9IHRydWUsXG4gIGZpbHRlciA9IChhY3Rpb24sIHN0YXRlQmVmb3JlLCBzdGF0ZUFmdGVyKSA9PiB0cnVlLFxuICB0cmFuc2Zvcm1lciA9IHN0YXRlID0+IHN0YXRlLFxuICBsb2dnZXIgPSBjb25zb2xlXG59ID0ge30pIHtcbiAgcmV0dXJuIHN0b3JlID0+IHtcbiAgICBsZXQgcHJldlN0YXRlID0gZGVlcENvcHkoc3RvcmUuc3RhdGUpXG5cbiAgICBzdG9yZS5zdWJzY3JpYmVBY3Rpb24oKHsgdHlwZSwgcGF5bG9hZCB9LCBzdGF0ZSkgPT4ge1xuICAgICAgaWYgKHR5cGVvZiBsb2dnZXIgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVyblxuICAgICAgfVxuICAgICAgY29uc3QgbmV4dFN0YXRlID0gZGVlcENvcHkoc3RhdGUpXG5cbiAgICAgIGlmIChmaWx0ZXIodHlwZSwgcHJldlN0YXRlLCBuZXh0U3RhdGUpKSB7XG4gICAgICAgIGNvbnN0IHRpbWUgPSBuZXcgRGF0ZSgpXG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZFRpbWUgPSBgIEAgJHtwYWQodGltZS5nZXRIb3VycygpLCAyKX06JHtwYWQodGltZS5nZXRNaW51dGVzKCksIDIpfToke3BhZCh0aW1lLmdldFNlY29uZHMoKSwgMil9LiR7cGFkKHRpbWUuZ2V0TWlsbGlzZWNvbmRzKCksIDMpfWBcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9ICdhY3Rpb24gJyArIHR5cGUgKyBmb3JtYXR0ZWRUaW1lXG4gICAgICAgIGNvbnN0IHN0YXJ0TWVzc2FnZSA9IGNvbGxhcHNlZFxuICAgICAgICAgID8gbG9nZ2VyLmdyb3VwQ29sbGFwc2VkXG4gICAgICAgICAgOiBsb2dnZXIuZ3JvdXBcblxuICAgICAgICAvLyByZW5kZXJcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBzdGFydE1lc3NhZ2UuY2FsbChsb2dnZXIsIG1lc3NhZ2UpXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKVxuICAgICAgICB9XG5cbiAgICAgICAgbG9nZ2VyLmxvZygnJWMgcGF5bG9hZCcsICdjb2xvcjogIzlFOUU5RTsgZm9udC13ZWlnaHQ6IGJvbGQnLCB7IHBheWxvYWQgfSlcbiAgICAgICAgbG9nZ2VyLmxvZygnJWMgc3RhdGUnLCAnY29sb3I6ICM0Q0FGNTA7IGZvbnQtd2VpZ2h0OiBib2xkJywgdHJhbnNmb3JtZXIobmV4dFN0YXRlKSlcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGxvZ2dlci5ncm91cEVuZCgpXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBsb2dnZXIubG9nKCfigJTigJQgbG9nIGVuZCDigJTigJQnKVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHByZXZTdGF0ZSA9IG5leHRTdGF0ZVxuICAgIH0pXG4gIH1cbn1cblxuZnVuY3Rpb24gcmVwZWF0IChzdHIsIHRpbWVzKSB7XG4gIHJldHVybiAobmV3IEFycmF5KHRpbWVzICsgMSkpLmpvaW4oc3RyKVxufVxuXG5mdW5jdGlvbiBwYWQgKG51bSwgbWF4TGVuZ3RoKSB7XG4gIHJldHVybiByZXBlYXQoJzAnLCBtYXhMZW5ndGggLSBudW0udG9TdHJpbmcoKS5sZW5ndGgpICsgbnVtXG59XG4iLCJpbXBvcnQgYWN0aW9uTG9nZ2VyIGZyb20gJy4vYWN0aW9uLWxvZ2dlcic7XG5pbXBvcnQgbXV0YXRpb25Mb2dnZXIgZnJvbSAnLi9tdXRhdGlvbi1sb2dnZXInO1xuXG5leHBvcnQge1xuICBhY3Rpb25Mb2dnZXIsXG4gIG11dGF0aW9uTG9nZ2VyXG59O1xuIiwiLy8gQ3JlZGl0czogYm9ycm93ZWQgY29kZSBmcm9tIHZ1ZWpzL3Z1ZXhcblxuaW1wb3J0IHsgZGVlcENvcHkgfSBmcm9tICcuL3V0aWwnXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZUxvZ2dlciAoe1xuICBjb2xsYXBzZWQgPSB0cnVlLFxuICBmaWx0ZXIgPSAobXV0YXRpb24sIHN0YXRlQmVmb3JlLCBzdGF0ZUFmdGVyKSA9PiB0cnVlLFxuICB0cmFuc2Zvcm1lciA9IHN0YXRlID0+IHN0YXRlLFxuICBtdXRhdGlvblRyYW5zZm9ybWVyID0gbXV0ID0+IG11dCxcbiAgbG9nZ2VyID0gY29uc29sZVxufSA9IHt9KSB7XG4gIHJldHVybiBzdG9yZSA9PiB7XG4gICAgbGV0IHByZXZTdGF0ZSA9IGRlZXBDb3B5KHN0b3JlLnN0YXRlKVxuXG4gICAgc3RvcmUuc3Vic2NyaWJlKChtdXRhdGlvbiwgc3RhdGUpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgbG9nZ2VyID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGNvbnN0IG5leHRTdGF0ZSA9IGRlZXBDb3B5KHN0YXRlKVxuXG4gICAgICBpZiAoZmlsdGVyKG11dGF0aW9uLCBwcmV2U3RhdGUsIG5leHRTdGF0ZSkpIHtcbiAgICAgICAgY29uc3QgdGltZSA9IG5ldyBEYXRlKClcbiAgICAgICAgY29uc3QgZm9ybWF0dGVkVGltZSA9IGAgQCAke3BhZCh0aW1lLmdldEhvdXJzKCksIDIpfToke3BhZCh0aW1lLmdldE1pbnV0ZXMoKSwgMil9OiR7cGFkKHRpbWUuZ2V0U2Vjb25kcygpLCAyKX0uJHtwYWQodGltZS5nZXRNaWxsaXNlY29uZHMoKSwgMyl9YFxuICAgICAgICBjb25zdCBmb3JtYXR0ZWRNdXRhdGlvbiA9IG11dGF0aW9uVHJhbnNmb3JtZXIobXV0YXRpb24pXG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgbXV0YXRpb24gJHttdXRhdGlvbi50eXBlfSR7Zm9ybWF0dGVkVGltZX1gXG4gICAgICAgIGNvbnN0IHN0YXJ0TWVzc2FnZSA9IGNvbGxhcHNlZFxuICAgICAgICAgID8gbG9nZ2VyLmdyb3VwQ29sbGFwc2VkXG4gICAgICAgICAgOiBsb2dnZXIuZ3JvdXBcblxuICAgICAgICAvLyByZW5kZXJcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBzdGFydE1lc3NhZ2UuY2FsbChsb2dnZXIsIG1lc3NhZ2UpXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKVxuICAgICAgICB9XG5cbiAgICAgICAgbG9nZ2VyLmxvZygnJWMgcHJldiBzdGF0ZScsICdjb2xvcjogIzlFOUU5RTsgZm9udC13ZWlnaHQ6IGJvbGQnLCB0cmFuc2Zvcm1lcihwcmV2U3RhdGUpKVxuICAgICAgICBsb2dnZXIubG9nKCclYyBtdXRhdGlvbicsICdjb2xvcjogIzAzQTlGNDsgZm9udC13ZWlnaHQ6IGJvbGQnLCBmb3JtYXR0ZWRNdXRhdGlvbilcbiAgICAgICAgbG9nZ2VyLmxvZygnJWMgbmV4dCBzdGF0ZScsICdjb2xvcjogIzRDQUY1MDsgZm9udC13ZWlnaHQ6IGJvbGQnLCB0cmFuc2Zvcm1lcihuZXh0U3RhdGUpKVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgbG9nZ2VyLmdyb3VwRW5kKClcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGxvZ2dlci5sb2coJ+KAlOKAlCBsb2cgZW5kIOKAlOKAlCcpXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcHJldlN0YXRlID0gbmV4dFN0YXRlXG4gICAgfSlcbiAgfVxufVxuXG5mdW5jdGlvbiByZXBlYXQgKHN0ciwgdGltZXMpIHtcbiAgcmV0dXJuIChuZXcgQXJyYXkodGltZXMgKyAxKSkuam9pbihzdHIpXG59XG5cbmZ1bmN0aW9uIHBhZCAobnVtLCBtYXhMZW5ndGgpIHtcbiAgcmV0dXJuIHJlcGVhdCgnMCcsIG1heExlbmd0aCAtIG51bS50b1N0cmluZygpLmxlbmd0aCkgKyBudW1cbn0iLCIvLyBDcmVkaXRzOiBib3Jyb3dlZCBjb2RlIGZyb20gdnVlanMvdnVleFxuXG4vKipcbiAqIEdldCB0aGUgZmlyc3QgaXRlbSB0aGF0IHBhc3MgdGhlIHRlc3RcbiAqIGJ5IHNlY29uZCBhcmd1bWVudCBmdW5jdGlvblxuICpcbiAqIEBwYXJhbSB7QXJyYXl9IGxpc3RcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZcbiAqIEByZXR1cm4geyp9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmaW5kIChsaXN0LCBmKSB7XG4gIHJldHVybiBsaXN0LmZpbHRlcihmKVswXVxufVxuXG4vKipcbiAqIERlZXAgY29weSB0aGUgZ2l2ZW4gb2JqZWN0IGNvbnNpZGVyaW5nIGNpcmN1bGFyIHN0cnVjdHVyZS5cbiAqIFRoaXMgZnVuY3Rpb24gY2FjaGVzIGFsbCBuZXN0ZWQgb2JqZWN0cyBhbmQgaXRzIGNvcGllcy5cbiAqIElmIGl0IGRldGVjdHMgY2lyY3VsYXIgc3RydWN0dXJlLCB1c2UgY2FjaGVkIGNvcHkgdG8gYXZvaWQgaW5maW5pdGUgbG9vcC5cbiAqXG4gKiBAcGFyYW0geyp9IG9ialxuICogQHBhcmFtIHtBcnJheTxPYmplY3Q+fSBjYWNoZVxuICogQHJldHVybiB7Kn1cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlZXBDb3B5IChvYmosIGNhY2hlID0gW10pIHtcbiAgLy8ganVzdCByZXR1cm4gaWYgb2JqIGlzIGltbXV0YWJsZSB2YWx1ZVxuICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogIT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIG9ialxuICB9XG5cbiAgLy8gaWYgb2JqIGlzIGhpdCwgaXQgaXMgaW4gY2lyY3VsYXIgc3RydWN0dXJlXG4gIGNvbnN0IGhpdCA9IGZpbmQoY2FjaGUsIGMgPT4gYy5vcmlnaW5hbCA9PT0gb2JqKVxuICBpZiAoaGl0KSB7XG4gICAgcmV0dXJuIGhpdC5jb3B5XG4gIH1cblxuICBjb25zdCBjb3B5ID0gQXJyYXkuaXNBcnJheShvYmopID8gW10gOiB7fVxuICAvLyBwdXQgdGhlIGNvcHkgaW50byBjYWNoZSBhdCBmaXJzdFxuICAvLyBiZWNhdXNlIHdlIHdhbnQgdG8gcmVmZXIgaXQgaW4gcmVjdXJzaXZlIGRlZXBDb3B5XG4gIGNhY2hlLnB1c2goe1xuICAgIG9yaWdpbmFsOiBvYmosXG4gICAgY29weVxuICB9KVxuXG4gIE9iamVjdC5rZXlzKG9iaikuZm9yRWFjaChrZXkgPT4ge1xuICAgIGNvcHlba2V5XSA9IGRlZXBDb3B5KG9ialtrZXldLCBjYWNoZSlcbiAgfSlcblxuICByZXR1cm4gY29weVxufVxuXG4vKipcbiAqIGZvckVhY2ggZm9yIG9iamVjdFxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9yRWFjaFZhbHVlIChvYmosIGZuKSB7XG4gIE9iamVjdC5rZXlzKG9iaikuZm9yRWFjaChrZXkgPT4gZm4ob2JqW2tleV0sIGtleSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc09iamVjdCAob2JqKSB7XG4gIHJldHVybiBvYmogIT09IG51bGwgJiYgdHlwZW9mIG9iaiA9PT0gJ29iamVjdCdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUHJvbWlzZSAodmFsKSB7XG4gIHJldHVybiB2YWwgJiYgdHlwZW9mIHZhbC50aGVuID09PSAnZnVuY3Rpb24nXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnQgKGNvbmRpdGlvbiwgbXNnKSB7XG4gIGlmICghY29uZGl0aW9uKSB0aHJvdyBuZXcgRXJyb3IoYFt2dWV4XSAke21zZ31gKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFydGlhbCAoZm4sIGFyZykge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBmbihhcmcpXG4gIH1cbn0iXSwic291cmNlUm9vdCI6IiJ9